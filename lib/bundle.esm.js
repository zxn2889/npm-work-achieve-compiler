function e(e){return function(e){const n=function(e){const n=1,t=2,o=3,r=4,i=5,l=6,c=[];let s=[],u=n;function d(e){const n=e.charCodeAt();return n>=65&&n<=90||n>=97&&n<=122||/^[\u4E00-\u9FA5]+$/.test(e)||/\s/.test(e)||/\w/.test(e)||"."===e}for(let p=0;p<e.length;p++){const h=e[p];if("<"!==h){if(d(h)){if(s.push(h),u===t){u=o;continue}if(u===n){u=r;continue}if(u===i){u=l;continue}}else if(">"===h){if(u===o){c.push({type:"startTag",tag:s.join("")}),s.length=0,u=n;continue}if(u===l){c.push({type:"endTag",tag:s.join("")}),s.length=0,u=n;continue}}else if("/"===h){u=i;continue}}else u===r&&(c.push({type:"text",content:s.join("")}),s.length=0),u=t}return c}(e),t={type:"Root",children:null},o=[],r=[];for(let e=0;e<n.length;e++){const t=n[e],i=t.type;if("startTag"===i){const e={type:"Element",tag:t.tag,children:[]},n=r[r.length-1];n?n.children.push(e):o.push(e),r.push(e)}else if("endTag"===i)r.pop();else if("text"===i){const e={type:"Text",content:t.content},n=r[r.length-1];n?n.children.push(e):o.push(eleNode)}}return t.children=o,t}(e)}function n(e,n){return()=>{"Text"===e.type&&(e.jsNode={type:"Text",context:e.content})}}function t(e,n){return()=>{if("Element"!==e.type)return;const n=function(e){return{type:"TagNode",name:e}}(e.tag),t={type:"CallExpression",id:(o="h",{type:"Identifier",name:o}),nodes:[n]};var o;1===e.children.length?t.nodes.push(e.children[0].jsNode):t.nodes.push(function(e){return{type:"ArrayParamsNode",params:e}}(e.children.map((e=>e.jsNode)))),e.jsNode=t}}function o(e,n){return()=>{if("Root"!==e.type)return;const n=e.children[0].jsNode;e.jsNode={type:"FunctionDecl",id:{type:"Identifier",name:"render"},params:[],body:[{type:"ReturnStatement",return:n}]}}}let r=null;function i(e,i=[]){const u={currentNode:null,childIndex:null,parentNode:null,funcs:[n,t,o].concat(i),removeASTNode:()=>s.call(u),replaceASTNode:e=>c.call(u,e)};!function(e){r=e}(u),l(e,u)}function l(e,n){n.currentNode=e;const t=e,o=n.funcs,r=[];if(o.length)for(let e=0;e<o.length;e++){const i=o[e](t,n);if(i&&r.push(i),!t)return}const i=t.children;if(i)for(let e=0;e<i.length;e++)n.childIndex=e,n.parentNode=t,l(i[e],n);if(r.length)for(let e=r.length-1;e>=0;e--)r[e]()}function c(e){this.parentNode&&(this.currentNode=e,this.parentNode.children[this.childIndex]=e)}function s(){this.parentNode&&(this.parentNode.children.splice(this.childIndex,1),this.currentNode=null)}function u(e,n=[]){i(e,n)}function d(){return r}function p(e){if("FunctionDecl"!==e.type)return;let n="";return"FunctionDecl"===e.type&&(n+="function"),"Identifier"===e.id.type&&(n+=` ${e.id.name}`),e.params.length?n+=`(${e.params.join()})`:n+="()",e.body.length?1===e.body.length&&"ReturnStatement"===e.body[0].type&&(n+=`{ return ${h(e.body[0].return)} }`):n+="{ return null }",n}function h(e){if("CallExpression"!==e.type)return;let n="";if("Identifier"===e.id.type&&(n+=e.id.name),e.nodes.length)if(1===e.nodes.length)n+=`(${e.nodes[0].name})`;else{for(let t=0;t<e.nodes.length;t++){const o=e.nodes[t];if("TagNode"===o.type)n+=`('${o.name}'`;else if("ArrayParamsNode"===o.type){if(n+=", [",o.params.length)for(let e=0;e<o.params.length;e++){const t=o.params[e];"CallExpression"===t.type&&(n+=`${h(t)}${e!==o.params.length-1?", ":""}`)}n+="]"}else"Text"===o.type&&(n+=`, ${o.context}`)}n+=")"}return n}function a(e){return function(e){if("jsNode"in e)return p(e.jsNode);console.warn("当前代码未经转换器转换")}(e)}function f(e,n=0){const t=e.type,o="Root"===t?"":"Element"===t?e.tag:e.content;if(console.log(`${"-".repeat(n)}${t}:${o}`),e.children)for(let t=0;t<e.children.length;t++)f(e.children[t],n+2)}export{a as createGenerator,u as createOptimizeParser,e as createParser,f as dump,d as getCurrentContext};
