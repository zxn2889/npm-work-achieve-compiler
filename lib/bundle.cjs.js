"use strict";var e,n;function t(n){return function(){var t;n.type===e.Text&&(n.jsNode=(t=n.content,{type:e.Text,context:t}))}}function o(t){return function(){if(t.type===e.Element){var o,r,i=function(n){return{type:e.TagNode,name:n}}(t.tag),c=(o=[i],{type:e.CallExpression,id:(r=n.H,{type:e.Identifier,name:r}),nodes:o});1===t.children.length?c.nodes.push(t.children[0].jsNode):c.nodes.push(function(n){return{type:e.ArrayParamsNode,params:n}}(t.children.map((function(e){return e.jsNode})))),t.jsNode=c}}}function r(t){return function(){if(t.type===e.Root){var o=t.children[0].jsNode;t.jsNode={type:e.FunctionDecl,id:{type:e.Identifier,name:n.Render},params:[],body:[{type:e.ReturnStatement,return:o}]}}}}!function(e){e[e.Root=0]="Root",e[e.Element=1]="Element",e[e.Text=2]="Text",e[e.FunctionDecl=3]="FunctionDecl",e[e.Identifier=4]="Identifier",e[e.ReturnStatement=5]="ReturnStatement",e[e.CallExpression=6]="CallExpression",e[e.TagNode=7]="TagNode",e[e.ArrayParamsNode=8]="ArrayParamsNode"}(e||(e={})),function(e){e.Render="render",e.H="h"}(n||(n={}));let i=null;function c(e,n=[]){const c={currentNode:null,childIndex:null,parentNode:null,funcs:[t,o,r].concat(n),removeASTNode:()=>s.call(c),replaceASTNode:e=>l.call(c,e)};!function(e){i=e}(c),a(e,c)}function a(e,n){n.currentNode=e;const t=e,o=n.funcs,r=[];if(o.length)for(let e=0;e<o.length;e++){const i=o[e](t,n);if(i&&r.push(i),!t)return}const i=t.children;if(i)for(let e=0;e<i.length;e++)n.childIndex=e,n.parentNode=t,a(i[e],n);if(r.length)for(let e=r.length-1;e>=0;e--)r[e]()}function l(e){this.parentNode&&(this.currentNode=e,this.parentNode.children[this.childIndex]=e)}function s(){this.parentNode&&(this.parentNode.children.splice(this.childIndex,1),this.currentNode=null)}function u(n){if(n.type===e.FunctionDecl){var t="";return n.type===e.FunctionDecl&&(t+="function"),n.id.type===e.Identifier&&(t+=" ".concat(n.id.name)),n.params.length?t+="(".concat(n.params.join(),")"):t+="()",n.body.length?1===n.body.length&&n.body[0].type===e.ReturnStatement&&(t+="{ return ".concat(d(n.body[0].return)," }")):t+="{ return null }",t}}function d(n){if(n.type===e.CallExpression){var t="";if(n.id.type===e.Identifier&&(t+=n.id.name),n.nodes.length)if(1===n.nodes.length)t+="(".concat(n.nodes[0].name,")");else{for(var o=0;o<n.nodes.length;o++){var r=n.nodes[o];if(r.type===e.TagNode)t+="('".concat(r.name,"'");else if(r.type===e.ArrayParamsNode){if(t+=", [",r.params.length)for(var i=0;i<r.params.length;i++){var c=r.params[i];c.type===e.CallExpression&&(t+="".concat(d(c)).concat(i!==r.params.length-1?", ":""))}t+="]"}else r.type===e.Text&&(t+=", ".concat(r.context))}t+=")"}return t}}exports.createGenerator=function(e){return function(e){if("jsNode"in e)return u(e.jsNode);console.warn("当前代码未经转换器转换")}(e)},exports.createOptimizeParser=function(e,n=[]){c(e,n)},exports.createParser=function(e){return function(e){const n=function(e){const n=1,t=2,o=3,r=4,i=5,c=6,a=[];let l=[],s=n;function u(e){const n=e.charCodeAt();return n>=65&&n<=90||n>=97&&n<=122||/^[\u4E00-\u9FA5]+$/.test(e)||/\s/.test(e)||/\w/.test(e)||"."===e}for(let d=0;d<e.length;d++){const p=e[d];if("<"!==p){if(u(p)){if(l.push(p),s===t){s=o;continue}if(s===n){s=r;continue}if(s===i){s=c;continue}}else if(">"===p){if(s===o){a.push({type:"startTag",tag:l.join("")}),l.length=0,s=n;continue}if(s===c){a.push({type:"endTag",tag:l.join("")}),l.length=0,s=n;continue}}else if("/"===p){s=i;continue}}else s===r&&(a.push({type:"text",content:l.join("")}),l.length=0),s=t}return a}(e),t={type:"Root",children:null},o=[],r=[];for(let e=0;e<n.length;e++){const t=n[e],i=t.type;if("startTag"===i){const e={type:"Element",tag:t.tag,children:[]},n=r[r.length-1];n?n.children.push(e):o.push(e),r.push(e)}else if("endTag"===i)r.pop();else if("text"===i){const e={type:"Text",content:t.content},n=r[r.length-1];n?n.children.push(e):o.push(eleNode)}}return t.children=o,t}(e)},exports.dump=function n(t,o){void 0===o&&(o=0);var r=t.type,i=r===e.Root?"":r===e.Element?t.tag:t.content;if(console.log("".concat("-".repeat(o)).concat(r,":").concat(i)),t.children)for(var c=0;c<t.children.length;c++)n(t.children[c],o+2)},exports.getCurrentContext=function(){return i};
