"use strict";let e=null;function t(t,c=[]){const l={currentNode:null,childIndex:null,parentNode:null,funcs:c,removeASTNode:()=>i.call(l),replaceASTNode:e=>o.call(l,e)};!function(t){e=t}(l),n(t,l)}function n(e,t){t.currentNode=e;const o=e,i=t.funcs;if(i.length)for(let e=0;e<i.length;e++)if(i[e](o,t),!o)return;const c=o.children;if(c)for(let e=0;e<c.length;e++)t.childIndex=e,t.parentNode=o,n(c[e],t)}function o(e){this.parentNode&&(this.currentNode=e,this.parentNode.children[this.childIndex]=e)}function i(){this.parentNode&&(this.parentNode.children.splice(this.childIndex,1),this.currentNode=null)}exports.createOptimizeParser=function(e,n=[]){t(e,n)},exports.createParser=function(e){return function(e){const t=function(e){const t=1,n=2,o=3,i=4,c=5,l=6,r=[];let s=[],u=t;function h(e){const t=e.charCodeAt();return t>=65&&t<=90||t>=97&&t<=122||/^[\u4E00-\u9FA5]+$/.test(e)||/\s/.test(e)||/\w/.test(e)||"."===e}for(let d=0;d<e.length;d++){const f=e[d];if("<"!==f){if(h(f)){if(s.push(f),u===n){u=o;continue}if(u===t){u=i;continue}if(u===c){u=l;continue}}else if(">"===f){if(u===o){r.push({type:"startTag",tag:s.join("")}),s.length=0,u=t;continue}if(u===l){r.push({type:"endTag",tag:s.join("")}),s.length=0,u=t;continue}}else if("/"===f){u=c;continue}}else u===i&&(r.push({type:"text",content:s.join("")}),s.length=0),u=n}return r}(e),n={type:"Root",children:null},o=[],i=[];for(let e=0;e<t.length;e++){const n=t[e],c=n.type;if("startTag"===c){const e={type:"Element",tag:n.tag,children:[]},t=i[i.length-1];t?t.children.push(e):o.push(e),i.push(e)}else if("endTag"===c)i.pop();else if("text"===c){const e={type:"Text",content:n.content},t=i[i.length-1];t?t.children.push(e):o.push(eleNode)}}return n.children=o,n}(e)},exports.dump=function e(t,n=0){const o=t.type,i="Root"===o?"":"Element"===o?t.tag:t.content;if(console.log(`${"-".repeat(n)}${o}:${i}`),t.children)for(let o=0;o<t.children.length;o++)e(t.children[o],n+2)},exports.getCurrentContext=function(){return e};
