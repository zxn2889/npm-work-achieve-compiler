!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).achieve={})}(this,(function(e){"use strict";let t=null;function n(e,n=[]){const l={currentNode:null,childIndex:null,parentNode:null,funcs:n,removeASTNode:()=>c.call(l),replaceASTNode:e=>i.call(l,e)};!function(e){t=e}(l),o(e,l)}function o(e,t){t.currentNode=e;const n=e,i=t.funcs;if(i.length)for(let e=0;e<i.length;e++)if(i[e](n,t),!n)return;const c=n.children;if(c)for(let e=0;e<c.length;e++)t.childIndex=e,t.parentNode=n,o(c[e],t)}function i(e){this.parentNode&&(this.currentNode=e,this.parentNode.children[this.childIndex]=e)}function c(){this.parentNode&&(this.parentNode.children.splice(this.childIndex,1),this.currentNode=null)}e.createOptimizeParser=function(e,t=[]){n(e,t)},e.createParser=function(e){return function(e){const t=function(e){const t=1,n=2,o=3,i=4,c=5,l=6,r=[];let u=[],s=t;function f(e){const t=e.charCodeAt();return t>=65&&t<=90||t>=97&&t<=122||/^[\u4E00-\u9FA5]+$/.test(e)||/\s/.test(e)||/\w/.test(e)||"."===e}for(let h=0;h<e.length;h++){const d=e[h];if("<"!==d){if(f(d)){if(u.push(d),s===n){s=o;continue}if(s===t){s=i;continue}if(s===c){s=l;continue}}else if(">"===d){if(s===o){r.push({type:"startTag",tag:u.join("")}),u.length=0,s=t;continue}if(s===l){r.push({type:"endTag",tag:u.join("")}),u.length=0,s=t;continue}}else if("/"===d){s=c;continue}}else s===i&&(r.push({type:"text",content:u.join("")}),u.length=0),s=n}return r}(e),n={type:"Root",children:null},o=[],i=[];for(let e=0;e<t.length;e++){const n=t[e],c=n.type;if("startTag"===c){const e={type:"Element",tag:n.tag,children:[]},t=i[i.length-1];t?t.children.push(e):o.push(e),i.push(e)}else if("endTag"===c)i.pop();else if("text"===c){const e={type:"Text",content:n.content},t=i[i.length-1];t?t.children.push(e):o.push(eleNode)}}return n.children=o,n}(e)},e.dump=function e(t,n=0){const o=t.type,i="Root"===o?"":"Element"===o?t.tag:t.content;if(console.log(`${"-".repeat(n)}${o}:${i}`),t.children)for(let o=0;o<t.children.length;o++)e(t.children[o],n+2)},e.getCurrentContext=function(){return t}}));
